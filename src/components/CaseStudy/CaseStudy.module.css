/* ========================================
 * Case Study Hero
 * ======================================== */

.hero {
  padding-top: var(--space-16);
}

.heroSeparator {
  display: flex;
  align-items: center;
  gap: var(--space-1);
  margin-top: var(--space-20);
  margin-bottom: var(--space-20);
}

.heroSeparatorRule {
  flex: 1;
  height: 1px;
  background-color: var(--border-primary);
}

/* ========================================
 * Detail Level Toggle (icon buttons — hidden)
 * ======================================== */

.detailToggle {
  display: none;
  align-items: flex-start;
  gap: var(--space-2);
}

.detailToggleButton {
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding: 0;
  border: none;
  background: none;
  color: var(--text-quaternary);
  cursor: pointer;
  border-radius: 0;
  transition: color 150ms ease-out;
}

.detailToggleButton:hover {
  color: var(--text-secondary);
}

.detailToggleButton[data-active] {
  color: var(--text-primary);
}

.detailToggleButton:focus-visible {
  outline: 2px solid var(--text-quaternary);
  outline-offset: 2px;
}

.detailToggleButton:focus:not(:focus-visible) {
  outline: none;
}

/* ========================================
 * Detail Level Segmented Control
 * ======================================== */

.segmentedControl {
  display: flex;
  position: relative;
  border: 1px solid var(--border-primary);
  border-radius: 999px;
  padding: 3px;
  background: var(--bg-primary);
}

.segmentedIndicator {
  position: absolute;
  top: 3px;
  left: 3px;
  width: calc((100% - 6px) / 3);
  height: calc(100% - 6px);
  background: var(--bg-secondary);
  border-radius: 999px;
  transition: transform 200ms var(--ease-out);
  pointer-events: none;
}

.segmentedButton {
  position: relative;
  z-index: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 24px;
  padding: 0;
  border: none;
  background: none;
  color: var(--text-quaternary);
  cursor: pointer;
  border-radius: 999px;
  transition: color 150ms ease-out;
}

.segmentedButton:hover {
  color: var(--text-secondary);
}

.segmentedButton[data-active] {
  color: var(--text-primary);
}

.segmentedButton:focus-visible {
  outline: 2px solid var(--text-quaternary);
  outline-offset: 2px;
}

.segmentedButton:focus:not(:focus-visible) {
  outline: none;
}

/* First section after separator - no extra margin since separator provides it */
.firstSection {
  margin-top: 0;
}

.title {
  font-family: var(--font-serif);
  font-size: var(--text-xl);
  font-weight: 400;
  letter-spacing: -0.02em;
  color: var(--text-primary);
  margin-bottom: var(--space-4);
}

.hook {
  font-size: var(--text-base);
  line-height: var(--leading-relaxed);
  color: var(--text-secondary);
  max-width: 32rem;
  margin-bottom: var(--space-12);
}

.meta {
  display: flex;
  gap: var(--space-8);
}

@media (max-width: 640px) {
  .meta {
    flex-direction: column;
    gap: var(--space-12);
  }
}

.metaItem {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.metaLabel {
  font-size: var(--text-xs);
  font-weight: 500;
  color: var(--text-quaternary);
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

.metaValue {
  font-size: var(--text-sm);
  color: var(--text-secondary);
}

/* ========================================
 * Chapter
 * ======================================== */

.chapter {
  margin-top: var(--space-12);
}

.chapterHeader {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  margin-bottom: var(--space-6);
}

.chapterTitle {
  font-family: var(--font-sans);
  font-size: var(--text-xs);
  font-weight: 500;
  color: var(--text-quaternary);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin-bottom: 0;
}

.chapterMeta {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.chapterDivider {
  width: 1px;
  height: 14px;
  background-color: var(--border-primary);
}

.chapterCounter {
  font-size: var(--text-xs);
  font-weight: 500;
  color: var(--text-quaternary);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-variant-numeric: tabular-nums;
}


/* ========================================
 * Stack Section (shared by Card & Figure stacks)
 * ======================================== */

.stackSection {
  margin-top: var(--space-12);
}

.stackHeader {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  margin-bottom: var(--space-6);
}

.stackTitle {
  font-family: var(--font-sans);
  font-size: var(--text-xs);
  font-weight: 500;
  color: var(--text-quaternary);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin: 0;
}

.stackDivider {
  width: 1px;
  height: 14px;
  background-color: var(--border-primary);
}

.stackCounter {
  font-size: var(--text-xs);
  font-weight: 500;
  color: var(--text-quaternary);
  letter-spacing: 0.08em;
  font-variant-numeric: tabular-nums;
}

/* ========================================
 * Card Stack (Interactive)
 * ======================================== */

.stackContainer {
  display: grid;
  outline: none;
  border-radius: 8px;
  /* Reserve space for the stacking offset (3 cards * 8px) */
  padding-right: 24px;
  padding-bottom: 24px;
}

.stackCard {
  grid-area: 1 / 1;
  width: 100%;
  padding: var(--space-6);
  background: var(--bg-primary);
  border: 1px solid var(--border-primary);
  border-radius: 8px;
  transition: 
    transform var(--duration-normal) var(--ease-out),
    opacity var(--duration-normal) var(--ease-out);
  
  /* Position based on stack position */
  transform: translateX(calc(var(--stack-pos) * 8px)) translateY(calc(var(--stack-pos) * 8px));
  z-index: calc(10 - var(--stack-pos));
  opacity: calc(1 - var(--stack-pos) * 0.12);
  
  /* Hide cards beyond position 3 */
  visibility: visible;
}

/* Active card */
.stackCard[data-active="true"] {
  cursor: default;
  z-index: 100;
}

/* Non-active cards - clickable with circle arrow cursor (mirrored to point right) */
.stackCard:not([data-active="true"]) {
  cursor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 640 640' fill='%23737373'%3E%3Cpath transform='translate(640,0) scale(-1,1)' d='M320 96C443.7 96 544 196.3 544 320C544 443.7 443.7 544 320 544C196.3 544 96 443.7 96 320C96 196.3 196.3 96 320 96zM320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576zM228.7 308.7C222.5 314.9 222.5 325.1 228.7 331.3L300.7 403.3C306.9 409.5 317.1 409.5 323.3 403.3C329.5 397.1 329.5 386.9 323.3 380.7L278.6 336L400 336C408.8 336 416 328.8 416 320C416 311.2 408.8 304 400 304L278.6 304L323.3 259.3C329.5 253.1 329.5 242.9 323.3 236.7C317.1 230.5 306.9 230.5 300.7 236.7L228.7 308.7z'/%3E%3C/svg%3E") 12 12, pointer;
}

/* Cards far back - hide them */
.stackCard[style*="--stack-pos: 4"],
.stackCard[style*="--stack-pos: 5"],
.stackCard[style*="--stack-pos: 6"],
.stackCard[style*="--stack-pos: 7"] {
  visibility: hidden;
}

.stackCardTitle {
  font-family: var(--font-sans);
  font-size: var(--text-base);
  font-weight: 500;
  color: var(--text-primary);
  letter-spacing: 0;
  margin-bottom: var(--space-2);
}

.stackCardBody {
  font-size: var(--text-base);
  line-height: var(--leading-relaxed);
  color: var(--text-secondary);
  opacity: 0.9;
}

/* Mobile — swipeable with visual stack peek */
@media (max-width: 640px) {
  .stackContainer {
    padding-right: 12px;
    padding-bottom: 12px;
    touch-action: pan-y;
  }

  .stackCard {
    width: 100%;
    transform: translateX(calc(var(--stack-pos) * 4px)) translateY(calc(var(--stack-pos) * 4px)) !important;
    opacity: calc(1 - var(--stack-pos) * 0.15) !important;
    z-index: calc(10 - var(--stack-pos));
    pointer-events: none;
    cursor: default !important;
  }

  .stackCard[data-active="true"] {
    pointer-events: auto;
    z-index: 100;
  }

  .stackCard[style*="--stack-pos: 3"],
  .stackCard[style*="--stack-pos: 4"],
  .stackCard[style*="--stack-pos: 5"],
  .stackCard[style*="--stack-pos: 6"],
  .stackCard[style*="--stack-pos: 7"] {
    visibility: hidden;
  }
}

/* ========================================
 * Figure Stack (Interactive)
 * ======================================== */

.figureStackContainer {
  position: relative;
  outline: none;
  border-radius: 8px;
  padding-bottom: 24px;
}

.stackFigure {
  position: absolute;
  top: 0;
  left: 0;
  width: calc(100% - 24px);
  margin: 0;
  transition: 
    transform var(--duration-normal) var(--ease-out),
    opacity var(--duration-normal) var(--ease-out);
  
  transform: translateX(calc(var(--stack-pos) * 8px)) translateY(calc(var(--stack-pos) * 8px));
  z-index: calc(10 - var(--stack-pos));
  opacity: calc(1 - var(--stack-pos) * 0.12);
}

.stackFigure[data-active="true"] {
  position: relative;
  cursor: default;
  z-index: 100;
}

/* Non-active figures - clickable with circle arrow cursor (mirrored to point right) */
.stackFigure:not([data-active="true"]) {
  cursor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 640 640' fill='%23737373'%3E%3Cpath transform='translate(640,0) scale(-1,1)' d='M320 96C443.7 96 544 196.3 544 320C544 443.7 443.7 544 320 544C196.3 544 96 443.7 96 320C96 196.3 196.3 96 320 96zM320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576zM228.7 308.7C222.5 314.9 222.5 325.1 228.7 331.3L300.7 403.3C306.9 409.5 317.1 409.5 323.3 403.3C329.5 397.1 329.5 386.9 323.3 380.7L278.6 336L400 336C408.8 336 416 328.8 416 320C416 311.2 408.8 304 400 304L278.6 304L323.3 259.3C329.5 253.1 329.5 242.9 323.3 236.7C317.1 230.5 306.9 230.5 300.7 236.7L228.7 308.7z'/%3E%3C/svg%3E") 12 12, pointer;
}

/* Hide figures beyond position 3 */
.stackFigure[style*="--stack-pos: 4"],
.stackFigure[style*="--stack-pos: 5"],
.stackFigure[style*="--stack-pos: 6"],
.stackFigure[style*="--stack-pos: 7"] {
  visibility: hidden;
}

.stackImagePlaceholder {
  width: 100%;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-primary);
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-quaternary);
  position: relative;
}

.imageTag {
  position: absolute;
  left: 6px;
  bottom: 6px;
  padding: 4px 8px;
  border-radius: 6px;
  font-size: var(--text-xs);
  font-weight: 500;
  color: var(--text-secondary);
  background: rgba(255, 255, 255, 0.65);
  border: 1px solid rgba(255, 255, 255, 0.4);
  backdrop-filter: blur(10px) saturate(160%);
  -webkit-backdrop-filter: blur(10px) saturate(160%);
  border: 1px solid var(--border-primary);
}

@media (prefers-color-scheme: dark) {
  .imageTag {
    color: var(--text-primary);
    background: rgba(10, 10, 10, 0.6);
    border-color: rgba(255, 255, 255, 0.12);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
  }
}

/* Mobile — swipeable with visual stack peek */
@media (max-width: 640px) {
  .figureStackContainer {
    display: grid;
    padding-right: 12px;
    padding-bottom: 12px;
    touch-action: pan-y;
  }

  .stackFigure {
    grid-area: 1 / 1;
    position: relative !important;
    width: 100% !important;
    transform: translateX(calc(var(--stack-pos) * 4px)) translateY(calc(var(--stack-pos) * 4px)) !important;
    opacity: calc(1 - var(--stack-pos) * 0.15) !important;
    z-index: calc(10 - var(--stack-pos));
    pointer-events: none;
    cursor: default !important;
  }

  .stackFigure[data-active="true"] {
    pointer-events: auto;
    z-index: 100;
  }

  .stackFigure[style*="--stack-pos: 3"],
  .stackFigure[style*="--stack-pos: 4"],
  .stackFigure[style*="--stack-pos: 5"],
  .stackFigure[style*="--stack-pos: 6"],
  .stackFigure[style*="--stack-pos: 7"] {
    visibility: hidden;
  }
}

/* ========================================
 * Figure / Image Placeholder
 * ======================================== */

.figure {
  margin-top: var(--space-6);
}

.figure + .figure {
  margin-top: var(--space-4);
}

.imagePlaceholder {
  width: 100%;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-primary);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-quaternary);
}

.caption {
  font-size: var(--text-sm);
  color: var(--text-tertiary);
  margin-top: var(--space-2);
  font-style: italic;
}

/* ========================================
 * Stats
 * ======================================== */

.statRow {
  display: flex;
  gap: var(--space-12);
  margin-bottom: var(--space-8);
}

.stat {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.statValue {
  font-family: var(--font-serif);
  font-size: var(--text-xl);
  font-weight: 400;
  color: var(--text-primary);
  letter-spacing: -0.02em;
}

.statLabel {
  font-size: var(--text-xs);
  font-weight: 500;
  color: var(--text-quaternary);
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

/* ========================================
 * Prose (Context, Learnings)
 * ======================================== */

.prose {
  font-size: var(--text-base);
  line-height: var(--leading-relaxed);
  color: var(--text-secondary);
}

.prose p + p {
  margin-top: var(--space-4);
}

.prose ul {
  margin-top: var(--space-4);
  padding-left: var(--space-4);
}

.prose li {
  margin-top: var(--space-2);
}

.prose li::marker {
  color: var(--text-quaternary);
}

.prose li {
  list-style-type: disc;
}

.subheading {
  font-family: var(--font-sans);
  font-size: var(--text-sm);
  font-weight: 500;
  color: var(--text-primary);
  margin-top: var(--space-8);
  margin-bottom: var(--space-3);
}

/* ========================================
 * Separator
 * ======================================== */

.separator {
  width: 3rem;
  height: 1px;
  background-color: var(--border-primary);
  margin: var(--space-20) 0;
}

/* ========================================
 * Next Case Study
 * ======================================== */

.nextSection {
  margin-top: var(--space-10);
}

.nextLabel {
  display: block;
  font-family: var(--font-sans);
  font-size: var(--text-xs);
  font-weight: 500;
  color: var(--text-quaternary);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin-bottom: var(--space-4);
}

/* ========================================
 * Page Bottom Padding
 * ======================================== */

.pageBottom {
  height: var(--space-20);
}
